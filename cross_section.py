import numpy as np
from matplotlib.pyplot import figure, plot, show
from matplotlib.figure import Figure
from scipy import interpolate as interp


def cross_section_calc():
    # Total alpha production cross section from Gautheron 2006 for 18O
    # alpha energies are in MeV and cross sections are in mbarn

    # This is hard coded because it is rarely if ever going to change
    # cross_sections = ['O18', 'F19']

    # 18O
    x_alpha_energies_18O = np.array([1,1.01,1.02,1.03,1.04,1.05,1.06,1.07,1.08,1.09,1.1,1.11,1.12,1.13,1.14,1.15,1.16,1.17,1.18,1.19,1.2,1.21,1.22,1.23,1.24,1.25,1.26,1.27,1.28,1.29,1.3,1.31,1.32,1.33,1.34,1.35,1.36,1.37,1.38,1.39,1.4,1.41,1.42,1.43,1.44,1.45,1.46,1.47,1.48,1.49,1.5,1.51,1.52,1.53,1.54,1.55,1.56,1.57,1.58,1.59,1.6,1.61,1.62,1.63,1.64,1.65,1.66,1.67,1.68,1.69,1.7,1.71,1.72,1.73,1.74,1.75,1.76,1.77,1.78,1.79,1.8,1.83,1.86,1.89,1.92,1.95,1.98,2.01,2.04,2.07,2.1,2.11,2.12,2.13,2.14,2.15,2.16,2.17,2.18,2.19,2.2,2.21,2.22,2.23,2.24,2.25,2.26,2.27,2.28,2.29,2.3,2.31,2.32,2.33,2.34,2.35,2.36,2.37,2.38,2.39,2.4,2.41,2.42,2.43,2.44,2.45,2.46,2.47,2.48,2.49,2.5,2.51,2.52,2.53,2.54,2.55,2.56,2.57,2.58,2.59,2.6,2.61,2.62,2.63,2.64,2.65,2.66,2.67,2.68,2.69,2.7,2.71,2.72,2.73,2.74,2.75,2.76,2.77,2.78,2.79,2.8,2.81,2.82,2.83,2.84,2.85,2.86,2.87,2.88,2.89,2.9,2.91,2.92,2.93,2.94,2.95,2.96,2.97,2.98,2.99,3,3.01,3.02,3.03,3.04,3.05,3.06,3.07,3.08,3.09,3.1,3.11,3.12,3.13,3.14,3.15,3.16,3.17,3.18,3.19,3.2,3.21,3.22,3.23,3.24,3.25,3.26,3.27,3.28,3.29,3.3,3.31,3.32,3.33,3.34,3.35,3.36,3.37,3.38,3.39,3.4,3.41,3.42,3.43,3.44,3.45,3.46,3.47,3.48,3.49,3.5,3.51,3.52,3.53,3.54,3.55,3.56,3.57,3.58,3.59,3.6,3.61,3.62,3.63,3.64,3.65,3.66,3.67,3.68,3.69,3.7,3.71,3.72,3.73,3.74,3.75,3.76,3.77,3.78,3.79,3.8,3.81,3.82,3.83,3.84,3.85,3.86,3.87,3.88,3.89,3.9,3.91,3.92,3.93,3.94,3.95,3.96,3.97,3.98,3.99,4,4.01,4.02,4.03,4.04,4.05,4.06,4.07,4.08,4.09,4.1,4.11,4.12,4.13,4.14,4.15,4.16,4.17,4.18,4.19,4.2,4.21,4.22,4.23,4.24,4.25,4.26,4.27,4.28,4.29,4.3,4.31,4.32,4.33,4.34,4.35,4.36,4.37,4.38,4.39,4.4,4.41,4.42,4.43,4.44,4.45,4.46,4.47,4.48,4.49,4.5,4.51,4.52,4.53,4.54,4.55,4.56,4.57,4.58,4.59,4.6,4.61,4.62,4.63,4.64,4.65,4.66,4.67,4.68,4.69,4.7,4.71,4.72,4.73,4.74,4.75,4.76,4.77,4.78,4.79,4.8,4.81,4.82,4.83,4.84,4.85,4.86,4.87,4.88,4.89,4.9,4.91,4.92,4.93,4.94,4.95,4.96,4.97,4.98,4.99,5,5.01,5.02,5.03,5.04,5.05,5.06,5.07,5.08,5.09,5.1,5.11,5.12,5.13,5.14,5.15,5.16,5.17,5.18,5.19,5.2,5.21,5.22,5.23,5.24,5.25,5.26,5.27,5.28,5.29,5.3,5.31,5.32,5.33,5.34,5.35,5.36,5.37,5.38,5.39,5.4,5.41,5.42,5.43,5.44,5.45,5.46,5.47,5.48,5.49,5.5,5.51,5.52,5.53,5.54,5.55,5.56,5.57,5.58,5.59,5.6,5.61,5.62,5.63,5.64,5.65,5.66,5.67,5.68,5.69,5.7,5.71,5.72,5.73,5.74,5.75,5.76,5.77,5.78,5.79,5.8,5.81,5.82,5.83,5.84,5.85,5.86,5.87,5.88,5.89,5.9,5.91,5.92,5.93,5.94,5.95,5.96,5.97,5.98,5.99,6,6.01,6.02,6.03,6.04,6.05,6.06,6.07,6.08,6.09,6.1,6.11,6.12,6.13,6.14,6.15,6.16,6.17,6.18,6.19,6.2,6.21,6.22,6.23,6.24,6.25,6.26,6.27,6.28,6.29,6.3,6.31,6.32,6.33,6.34,6.35,6.36,6.37,6.38,6.39,6.4,6.41,6.42,6.43,6.44,6.45,6.46,6.47,6.48,6.49,6.5,6.51,6.52,6.53,6.54,6.55,6.56,6.57,6.58,6.59,6.6,6.61,6.62,6.63,6.64,6.65,6.66,6.67,6.68,6.69,6.7,6.71,6.72,6.73,6.74,6.75,6.76,6.77,6.78,6.79,6.8,6.81,6.82,6.83,6.84,6.85,6.86,6.87,6.88,6.89,6.9,6.91,6.92,6.93,6.94,6.95,6.96,6.97,6.98,6.99,7,7.01,7.02,7.03,7.04,7.05,7.06,7.07,7.08,7.09,7.1,7.11,7.12,7.13,7.14,7.15,7.16,7.17,7.18,7.19,7.2,7.21,7.22,7.23,7.24,7.25,7.26,7.27,7.28,7.29,7.3,7.31,7.32,7.33,7.34,7.35,7.36,7.37,7.38,7.39,7.4,7.41,7.42,7.43,7.44,7.45,7.46,7.47,7.48,7.49,7.5,7.51,7.52,7.53,7.54,7.55,7.56,7.57,7.58,7.59,7.6,7.61,7.62,7.63,7.64,7.65,7.66,7.67,7.68,7.69,7.7,7.71,7.72,7.73,7.74,7.75,7.76,7.77,7.78,7.79,7.8,7.81,7.82,7.83,7.84,7.85,7.86,7.87,7.88,7.89,7.9,7.91,7.92,7.93,7.94,7.95,7.96,7.97,7.98,7.99,8,8.01,8.02,8.03,8.04,8.05,8.06,8.07,8.08,8.09,8.1,8.11,8.12,8.13,8.14,8.15,8.16,8.17,8.18,8.19,8.2,8.21,8.22,8.23,8.24,8.25,8.26,8.27,8.28,8.29,8.3,8.31,8.32,8.33,8.34,8.35,8.36,8.37,8.38,8.39,8.4,8.41,8.42,8.43,8.44,8.45,8.46,8.47,8.48,8.49,8.5,8.51,8.52,8.53,8.54,8.55,8.56,8.57,8.58,8.59,8.6,8.61,8.62,8.63,8.64,8.65,8.66,8.67,8.68,8.69,8.7,8.71,8.72,8.73,8.74,8.75,8.76,8.77,8.78,8.79,8.8,8.81,8.82,8.83,8.84,8.85,8.86,8.87,8.88,8.89,8.9,8.91,8.92,8.93,8.94,8.95,8.96,8.97,8.98,8.99,9,9.01,9.02,9.03,9.04,9.05,9.06,9.07,9.08,9.09,9.1,9.11,9.12,9.13,9.14,9.15,9.16,9.17,9.18,9.19,9.2,9.21,9.22,9.23,9.24,9.25,9.26,9.27,9.28,9.29,9.3,9.31,9.32,9.33,9.34,9.35,9.36,9.37,9.38,9.39,9.4,9.41,9.42,9.43,9.44,9.45,9.46,9.47,9.48,9.49,9.5,9.51,9.52,9.53,9.54,9.55,9.56,9.57,9.58,9.59,9.6,9.61,9.62,9.63,9.64,9.65,9.66,9.67,9.68,9.69,9.7,9.71,9.72,9.73,9.74,9.75,9.76,9.77,9.78,9.79,9.8,9.81,9.82,9.83,9.84,9.85,9.86,9.87,9.88,9.89,9.9,9.91,9.92,9.93,9.94,9.95,9.96,9.97,9.98,9.99,10,10.01,10.02,10.03,10.04,10.05,10.06,10.07,10.08,10.09,10.1,10.11,10.12,10.13,10.14,10.15,10.16,10.17,10.18,10.19,10.2,10.21,10.22,10.23,10.24,10.25,10.26,10.27,10.28,10.29,10.3,10.31,10.32,10.33,10.34,10.35,10.36,10.37,10.38,10.39,10.4,10.41,10.42,10.43,10.44,10.45,10.46,10.47,10.48,10.49,10.5,10.51,10.52,10.53,10.54,10.55,10.56,10.57,10.58,10.59,10.6,10.61,10.62,10.63,10.64,10.65,10.66,10.67,10.68,10.69,10.7,10.71,10.72,10.73,10.74,10.75,10.76,10.77,10.78,10.79,10.8,10.81,10.82,10.83,10.84,10.85,10.86,10.87,10.88,10.89,10.9,10.91,10.92,10.93,10.94,10.95,10.96,10.97,10.98,10.99,11,11.01,11.02,11.03,11.04,11.05,11.06,11.07,11.08,11.09,11.1,11.11,11.12,11.13,11.14,11.15,11.16,11.17,11.18,11.19,11.2,11.21,11.22,11.23,11.24,11.25,11.26,11.27,11.28,11.29,11.3,11.31,11.32,11.33,11.34,11.35,11.36,11.37,11.38,11.39,11.4,11.41,11.42,11.43,11.44,11.45,11.46,11.47,11.48,11.49,11.5,11.51,11.52,11.53,11.54,11.55,11.56,11.57,11.58,11.59,11.6,11.61,11.62,11.63,11.64,11.65,11.66,11.67,11.68,11.69,11.7,11.71,11.72,11.73,11.74,11.75,11.76,11.77,11.78,11.79,11.8,11.81,11.82,11.83,11.84,11.85,11.86,11.87,11.88,11.89,11.9,11.91,11.92,11.93,11.94,11.95,11.96,11.97,11.98,11.99,12,12.01,12.02,12.03,12.04,12.05,12.06,12.07,12.08,12.09,12.1,12.11,12.12,12.13,12.14,12.15,12.16,12.17,12.18,12.19,12.2,12.21,12.22,12.23,12.24,12.25,12.26,12.27,12.28,12.29,12.3,12.31,12.32,12.33,12.34,12.35,12.36,12.37,12.38,12.39])
    cross_sections_18O = np.array([0,0,0.001,0.002,0.002,0.003,0.004,0.005,0.005,0.006,0.006,0.006,0.006,0.006,0.006,0.006,0.006,0.007,0.007,0.007,0.008,0.009,0.01,0.011,0.012,0.014,0.015,0.016,0.016,0.017,0.017,0.017,0.017,0.017,0.017,0.019,0.023,0.028,0.035,0.045,0.058,0.074,0.093,0.114,0.137,0.16,0.184,0.208,0.231,0.253,0.273,0.29,0.305,0.316,0.324,0.327,0.325,0.318,0.306,0.288,0.263,0.232,0.196,0.159,0.122,0.089,0.062,0.043,0.036,0.042,0.064,0.104,0.16,0.23,0.311,0.401,0.496,0.595,0.695,0.793,0.886,1.129,1.327,1.496,1.655,1.819,2.006,2.232,2.516,2.873,3.321,3.492,3.668,3.843,4.008,4.158,4.286,4.384,4.445,4.463,4.431,4.346,4.22,4.071,3.915,3.768,3.649,3.572,3.556,3.617,3.772,4.04,4.45,5.036,5.828,6.861,8.165,9.774,11.718,14.032,16.747,19.87,23.311,26.952,30.678,34.372,37.919,41.201,44.103,46.508,48.3,49.399,49.871,49.816,49.335,48.53,47.502,46.353,45.182,44.093,43.185,42.542,42.177,42.084,42.257,42.691,43.38,44.318,45.499,46.919,48.572,50.443,52.487,54.65,56.876,59.112,61.304,63.396,65.336,67.068,68.538,69.702,70.553,71.095,71.332,71.266,70.902,70.243,69.293,68.054,66.531,64.737,62.723,60.551,58.283,55.981,53.705,51.518,49.482,47.657,46.105,44.881,44.008,43.504,43.385,43.667,44.368,45.503,47.091,49.146,51.687,54.713,58.161,61.949,65.997,70.226,74.554,78.901,83.186,87.33,91.252,94.878,98.165,101.077,103.577,105.628,107.195,108.241,108.729,108.623,107.887,106.519,104.66,102.483,100.165,97.88,95.802,94.108,92.972,92.568,93.072,94.621,97.204,100.77,105.269,110.653,116.872,123.875,131.614,140.038,149.098,158.71,168.651,178.664,188.492,197.878,206.564,214.293,220.808,225.852,229.168,230.604,230.434,229.036,226.788,224.071,221.262,218.74,216.885,216.074,216.688,218.997,222.846,227.971,234.109,240.997,248.371,255.969,263.527,270.783,277.472,283.361,288.329,292.287,295.142,296.805,297.185,296.19,293.731,289.715,284.053,276.725,267.999,258.213,247.708,236.822,225.896,215.267,205.275,196.26,188.561,182.449,177.926,174.924,173.377,173.219,174.383,176.802,180.41,185.139,190.922,197.691,205.364,213.854,223.075,232.942,243.369,254.27,265.561,277.154,288.962,300.885,312.74,324.325,335.443,345.891,355.47,363.98,371.221,376.993,381.094,383.394,384.031,383.209,381.135,378.013,374.051,369.453,364.425,359.173,353.904,348.81,344.039,339.729,336.017,333.039,330.933,329.835,329.882,331.212,333.959,338.177,343.576,349.782,356.42,363.115,369.493,375.179,379.799,382.978,384.341,383.618,380.949,376.577,370.745,363.697,355.677,346.927,337.692,328.214,318.74,309.496,300.663,292.409,284.901,278.306,272.791,268.523,265.668,264.395,264.87,267.16,270.932,275.755,281.195,286.821,292.2,296.898,300.485,302.527,302.592,300.426,296.484,291.402,285.812,280.35,275.649,272.343,271.068,272.456,277.142,285.536,297.148,311.264,327.171,344.154,361.499,378.493,394.422,408.57,420.223,428.858,434.691,438.128,439.575,439.437,438.119,436.027,433.567,431.144,429.164,427.946,427.468,427.621,428.295,429.381,430.772,432.357,434.029,435.677,437.194,438.493,439.581,440.485,441.236,441.862,442.393,442.856,443.281,443.697,444.133,444.612,445.131,445.683,446.261,446.855,447.457,448.061,448.658,449.239,449.797,450.326,450.825,451.298,451.745,452.168,452.571,452.953,453.319,453.669,454.005,454.329,454.641,454.939,455.223,455.492,455.745,455.98,456.198,456.397,456.576,456.735,456.874,456.995,457.098,457.185,457.257,457.314,457.359,457.391,457.413,457.425,457.429,457.425,457.417,457.404,457.388,457.371,457.354,457.339,457.327,457.319,457.317,457.322,457.335,457.358,457.391,457.437,457.496,457.569,457.659,457.766,457.892,458.038,458.206,458.397,458.613,458.856,459.126,459.426,459.757,460.12,460.517,460.947,461.412,461.912,462.448,463.02,463.629,464.275,464.96,465.683,466.444,467.241,468.072,468.937,469.832,470.758,471.712,472.693,473.7,474.731,475.785,476.86,477.955,479.07,480.202,481.35,482.514,483.692,484.882,486.084,487.296,488.518,489.75,490.989,492.236,493.489,494.748,496.012,497.28,498.552,499.826,501.104,502.384,503.667,504.951,506.238,507.527,508.817,510.108,511.4,512.694,513.987,515.281,516.574,517.867,519.158,520.448,521.736,523.022,524.306,525.586,526.864,528.138,529.408,530.675,531.937,533.194,534.446,535.693,536.934,538.17,539.399,540.621,541.837,543.045,544.246,545.438,546.623,547.798,548.965,550.122,551.27,552.408,553.536,554.653,555.759,556.854,557.938,559.009,560.068,561.115,562.149,563.17,564.177,565.171,566.15,567.115,568.065,569,569.919,570.824,571.713,572.587,573.445,574.289,575.119,575.933,576.733,577.519,578.29,579.048,579.791,580.52,581.236,581.938,582.626,583.301,583.963,584.611,585.246,585.869,586.478,587.075,587.659,588.231,588.791,589.338,589.873,590.396,590.907,591.407,591.894,592.371,592.836,593.289,593.732,594.163,594.583,594.993,595.392,595.78,596.158,596.526,596.883,597.231,597.568,597.895,598.213,598.521,598.82,599.109,599.389,599.659,599.921,600.174,600.418,600.654,600.88,601.099,601.309,601.511,601.705,601.891,602.07,602.24,602.403,602.559,602.707,602.848,602.982,603.109,603.229,603.342,603.448,603.548,603.642,603.729,603.811,603.886,603.955,604.019,604.077,604.129,604.176,604.218,604.254,604.285,604.312,604.333,604.35,604.362,604.369,604.373,604.372,604.366,604.357,604.344,604.327,604.307,604.283,604.256,604.225,604.191,604.155,604.115,604.072,604.027,603.979,603.929,603.876,603.822,603.765,603.706,603.645,603.583,603.519,603.453,603.386,603.318,603.249,603.178,603.107,603.035,602.962,602.889,602.815,602.741,602.667,602.593,602.519,602.445,602.371,602.298,602.225,602.153,602.081,602.011,601.941,601.873,601.806,601.74,601.676,601.613,601.552,601.493,601.436,601.381,601.328,601.278,601.23,601.185,601.142,601.102,601.065,601.031,601,600.973,600.949,600.928,600.911,600.898,600.888,600.883,600.882,600.885,600.892,600.904,600.92,600.941,600.967,600.998,601.033,601.074,601.121,601.172,601.23,601.293,601.361,601.436,601.517,601.604,601.697,601.796,601.902,602.015,602.134,602.26,602.394,602.534,602.682,602.836,602.999,603.169,603.346,603.532,603.725,603.927,604.136,604.354,604.58,604.815,605.058,605.31,605.571,605.841,606.121,606.409,606.707,607.014,607.331,607.657,607.994,608.34,608.697,609.064,609.441,609.828,610.226,610.635,611.055,611.485,611.927,612.379,612.843,613.319,613.805,614.304,614.814,615.336,615.87,616.416,616.974,617.545,618.128,618.724,619.332,619.953,620.588,621.235,621.896,622.57,623.257,623.958,624.672,625.401,626.143,626.899,627.669,628.453,629.251,630.064,630.892,631.734,632.591,633.464,634.352,635.255,636.174,637.109,638.06,639.027,640.01,641.008,642.02,643.048,644.089,645.145,646.214,647.297,648.393,649.501,650.621,651.753,652.895,654.047,655.208,656.378,657.556,658.741,659.933,661.132,662.336,663.545,664.759,665.977,667.199,668.424,669.65,670.879,672.109,673.34,674.571,675.802,677.031,678.259,679.485,680.708,681.928,683.144,684.355,685.562,686.763,687.957,689.145,690.326,691.499,692.663,693.818,694.964,696.1,697.225,698.339,699.441,700.531,701.607,702.67,703.72,704.754,705.773,706.776,707.763,708.734,709.686,710.62,711.536,712.433,713.31,714.166,715.001,715.815,716.609,717.382,718.137,718.874,719.593,720.297,720.985,721.658,722.318,722.965,723.6,724.225,724.839,725.444,726.04,726.629,727.212,727.788,728.36,728.928,729.492,730.054,730.615,731.176,731.736,732.298,732.862,733.429,734,734.575,735.155,735.74,736.328,736.921,737.518,738.118,738.722,739.329,739.939,740.552,741.169,741.788,742.409,743.033,743.659,744.287,744.917,745.549,746.182,746.817,747.452,748.089,748.727,749.365,750.004,750.644,751.283,751.923,752.562,753.201,753.84,754.478,755.115,755.751,756.386,757.02,757.652,758.282,758.911,759.538,760.163,760.785,761.405,762.022,762.637,763.248,763.857,764.462,765.063,765.661,766.255,766.845,767.431,768.013,768.59,769.162,769.73,770.293,770.85,771.402,771.949,772.49,773.025,773.555,774.078,774.594,775.105,775.608,776.105,776.595,777.077,777.553,778.02,778.481,778.933,779.377,779.813,780.241,780.66,781.07,781.472,781.865,782.248,782.622,782.987,783.342,783.687,784.022,784.347,784.662,784.966,785.259,785.542,785.813,786.074,786.323,786.56,786.786,787,787.202,787.392,787.571,787.737,787.893,788.037,788.17,788.292,788.403,788.504,788.594,788.674,788.743,788.803,788.853,788.892,788.923,788.943,788.955,788.957,788.95,788.935,788.91,788.877,788.836,788.786,788.728,788.663,788.589,788.508,788.419,788.323,788.22,788.109,787.992,787.868,787.737,787.6,787.457,787.307,787.151,786.99,786.823,786.65,786.472,786.288,786.1,785.907,785.709,785.506,785.299,785.088,784.872,784.652,784.429,784.201,783.97,783.735,783.496,783.254,783.008,782.76,782.509,782.255,781.999,781.742,781.483,781.223,780.963])

    # 19F
    x_alpha_energies_19F = np.array([2.3629,3.0687,3.5,4.5,4.7648,5.4761,6,6.6232,7.1354,2.5,3.1583,4,4.7078,5,5.5,6.0675,6.8509,7.2915,3,3.4415,4.2129,4.726,5.0403,5.9574,6.5,7,7.5,7.5639,7.7734,7.9586,8.1402,8.5373,9,10.5,10.7,11,7.5918,7.84,8,8.4913,8.6172,9.5,10.522,10.8,11.1,7.6414,7.9114,8.0652,8.5,8.8,10,10.6,10.9,11.2])
    cross_sections_19F = 1000*np.array([0,0.0054251,0.027363,0.097599,0.11334,0.20274,0.25477,0.29583,0.32435,0.0003312,0.009016,0.061753,0.10749,0.14731,0.20651,0.25844,0.31007,0.3307,0.0042345,0.023887,0.076145,0.10889,0.15086,0.24922,0.2916,0.32037,0.34424,0.34474,0.35257,0.36594,0.37482,0.39541,0.4256,0.47749,0.48139,0.4874,0.34532,0.35695,0.37008,0.39402,0.39803,0.4426,0.47792,0.48337,0.48941,0.34683,0.36183,0.37171,0.39475,0.40555,0.4657,0.47943,0.48537,0.49186])

    x_alpha_energies = {'O18':x_alpha_energies_18O,'F19':x_alpha_energies_19F}
    cross_sections = {'O18':cross_sections_18O,'F19':cross_sections_19F}

    cross_section_interp_function = {}
    x_alpha_energies_interp = {}
    cross_sections_interp = {}

    for i in cross_sections:
        cross_section_interp_function[i] = interp.interp1d(x_alpha_energies[i],cross_sections[i])
        x_alpha_energies_interp[i] = np.linspace(min(x_alpha_energies[i]), max(x_alpha_energies[i]), num=100, endpoint=True)
        cross_sections_interp[i] = cross_section_interp_function[i](x_alpha_energies_interp[i])

    return x_alpha_energies, cross_sections, x_alpha_energies_interp, cross_sections_interp


class YieldFigure(Figure):
    def __init__(self, *args, **kwargs):

        figtitle = kwargs.pop('figtitle', 'testfigure')
        Figure.__init__(self, *args, **kwargs)
        self.text(0.5, 0.95, figtitle, ha='center')


def xsection(target):
    x_alpha_energies, cross_sections, x_alpha_energies_interp, cross_sections_interp = cross_section_calc()
    return x_alpha_energies_interp[target], cross_sections_interp[target], min(x_alpha_energies[target]), max(x_alpha_energies[target])


def xsection_plot(target):
    x_alpha_energies, cross_sections, x_alpha_energies_interp, cross_sections_interp = cross_section_calc()
    fig = figure(FigureClass=YieldFigure, figtitle='Cross Section')
    ax = fig.add_subplot(111)
    ax.plot(x_alpha_energies[target], cross_sections[target], 'o')
    ax.plot(x_alpha_energies_interp[target],cross_sections_interp[target])
    show()
    return fig
